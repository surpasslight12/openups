# Changelog

æ‰€æœ‰é‡è¦çš„é¡¹ç›®å˜æ›´éƒ½å°†è®°å½•åœ¨æ­¤æ–‡ä»¶ä¸­ã€‚

æ ¼å¼åŸºäº [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)ï¼Œ
ç‰ˆæœ¬å·éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)ã€‚

---

## [Unreleased]

### Added
- **ç³»ç»Ÿè°ƒç”¨å®‰å…¨å¢å¼º** ğŸ”’
  - æ›¿æ¢ `system()` è°ƒç”¨ä¸º `fork()/execv()` å®ç°ï¼Œé¿å… shell æ³¨å…¥æ”»å‡»
  - ä¸ºå…³æœºå‘½ä»¤æ‰§è¡Œæ·»åŠ  5 ç§’è¶…æ—¶ä¿æŠ¤ï¼Œé˜²æ­¢ç³»ç»Ÿå‘½ä»¤å¡æ­»
  - æ”¹è¿›å­è¿›ç¨‹ç®¡ç†ï¼Œä½¿ç”¨ `waitpid()` å¸¦ WNOHANG éé˜»å¡ç­‰å¾…
  - æ–°å¢ STDOUT é‡å®šå‘åˆ° /dev/nullï¼Œé¿å…å‘½ä»¤è¾“å‡ºæ±¡æŸ“æ—¥å¿—
  - è¯¦ç»†çš„æ‰§è¡Œç»“æœæ—¥å¿—ï¼ˆåŒ…æ‹¬é€€å‡ºç å’Œä¿¡å·ä¿¡æ¯ï¼‰

- **Makefile å¸®åŠ©ä¿¡æ¯å®Œå–„** ğŸ“–
  - æ‰©å±• `make help` è¾“å‡ºï¼ŒåŒ…æ‹¬å®Œæ•´çš„ç›®æ ‡è¯´æ˜ã€å˜é‡åˆ—è¡¨å’Œå®ç”¨ä¾‹å­
  - æ·»åŠ æ–‡æ¡£å¯¼èˆªï¼ˆREADME.md, QUICKSTART.md, TECHNICAL.md, CONTRIBUTING.mdï¼‰
  - æå‡æ–°ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒå’Œå­¦ä¹ æ›²çº¿

- **systemd æœåŠ¡é…ç½®å¢å¼º** âš™ï¸
  - æ”¹è¿› `TimeoutStopSec=10`ï¼ˆä¼˜é›…å…³é—­è¶…æ—¶ï¼‰
  - æ–°å¢ `StartLimitInterval=300` å’Œ `StartLimitBurst=3`ï¼ˆé‡å¯é™æµï¼‰
  - ä¼˜åŒ– `WatchdogSec=5`ï¼ˆæ›´ç²¾ç¡®çš„ watchdog è¶…æ—¶ï¼‰
  - æ·»åŠ è¯¦ç»†çš„é…ç½®è¯´æ˜æ³¨é‡Š

- **æ–‡æ¡£å®Œå–„** ğŸ“š
  - README.md: æ–°å¢"æ€§èƒ½åŸºå‡†"ç« èŠ‚ï¼ˆCPU/å†…å­˜/ç½‘ç»œå ç”¨ç»Ÿè®¡ï¼‰
  - README.md: æ–°å¢"å·²çŸ¥é™åˆ¶"ç« èŠ‚ï¼ˆç½‘ç»œã€ç³»ç»Ÿã€å…³æœºæœºåˆ¶é™åˆ¶ï¼‰
  - æ·»åŠ  IPv6 å»¶è¿Ÿç‰¹å¾å’Œæ•°æ®åº“çº¦æŸè¯´æ˜

### Changed
- **ä»£ç æ³¨é‡Šå…¨é¢å¢å¼º** ğŸ“
  - ä¸º monitor.c æ·»åŠ è¯¦ç»†çš„ç›‘æ§å¾ªç¯ã€é‡è¯•æœºåˆ¶ã€ä¿¡å·å¤„ç†ã€watchdog å¿ƒè·³æ³¨é‡Š
  - ä¸º icmp.c æ·»åŠ  ICMP æ ¡éªŒå’Œç®—æ³•ã€IPv4/IPv6 åè®®å®ç°çš„æ·±å…¥æ³¨é‡Š
  - ä¸º config.c æ·»åŠ å‚æ•°ä¼˜å…ˆçº§ã€éªŒè¯é€»è¾‘ã€å®‰å…¨æ€§æ£€æŸ¥çš„è¯¦ç»†è¯´æ˜
  - ä¸º systemd.c æ·»åŠ  UNIX domain socketã€é€šçŸ¥æœºåˆ¶ã€watchdog è¶…æ—¶çš„æ³¨é‡Š
  - ä¸º main.c æ·»åŠ ç¨‹åºåˆå§‹åŒ–æµç¨‹ã€é…ç½®åŠ è½½é¡ºåºçš„æ³¨é‡Š
  - æ€»è®¡ 200+ ä¸ªæ³¨é‡Šå—ï¼Œè¦†ç›–æ‰€æœ‰å…³é”®å‡½æ•°å’Œå¤æ‚ç®—æ³•
  - ä»£ç è¡Œæ•°ä» 2,073 å¢åŠ åˆ° 2,150+ï¼ˆä¸»è¦æ˜¯æ–°å¢æ³¨é‡Šå’Œé”™è¯¯å¤„ç†ï¼‰

- **å…³æœºå‘½ä»¤ä¼˜åŒ–** âš¡
  - å½“å¯ç”¨ systemd é›†æˆæ—¶ï¼Œè‡ªåŠ¨ä¼˜å…ˆä½¿ç”¨ `systemctl poweroff` æ›¿ä»£ `/sbin/shutdown`
  - æä¾›æ›´ä¼˜é›…å’Œä¸€è‡´çš„å…³æœºæ–¹å¼
  - åœ¨ä¼ ç»Ÿ Linux ç¯å¢ƒä¸­ç»§ç»­ä½¿ç”¨ `/sbin/shutdown` å‘½ä»¤

### Removed
- **ç§»é™¤ syslog ç›¸å…³ä»£ç ** ğŸ§¹
  - å®Œå…¨ç§»é™¤ `use_syslog` é…ç½®é¡¹å’Œç›¸å…³ä»£ç 
  - ç§»é™¤ `--syslog` CLI å‚æ•°å’Œ `-Y` çŸ­é€‰é¡¹
  - ç§»é™¤ `OPENUPS_SYSLOG` ç¯å¢ƒå˜é‡
  - ç§»é™¤ systemd æœåŠ¡ä¸­çš„ `SyslogIdentifier` å’Œ `SyslogLevelPrefix` é…ç½®
  - åŸå› ï¼šstderr å·²é€šè¿‡ systemd çš„ `StandardOutput=journal` å’Œ `StandardError=journal` è‡ªåŠ¨æ•è·åˆ° journalctlï¼Œå®ç°å®Œå…¨å†—ä½™

### Documentation
- ğŸ“ ç§»é™¤æ‰€æœ‰ SYSLOG_*.md å’Œ SYSLOG_*.txt æ–‡æ¡£æ–‡ä»¶
- ğŸ“ README.md: ç§»é™¤ syslog ç›¸å…³ç« èŠ‚å’Œé…ç½®è¯´æ˜
- ğŸ“ QUICKSTART.md: ç§»é™¤"åœºæ™¯ 4.5: Syslog é›†ä¸­æ—¥å¿—ç®¡ç†"
- ğŸ“ TECHNICAL.md: æ›´æ–° logger æ¨¡å—è¯´æ˜ï¼Œç§»é™¤ syslog ç‰¹æ€§æè¿°
- ğŸ“ .github/copilot-instructions.md: åŒæ­¥ç§»é™¤ syslog ç›¸å…³æŒ‡å¯¼
- ğŸ“ test.sh: æ›´æ–°æµ‹è¯•å¥—ä»¶ï¼Œç§»é™¤ syslog æµ‹è¯•ï¼Œæ·»åŠ æ–°å‚æ•°æµ‹è¯•

---

## [1.2.0] - 2025-11-04

### ğŸ¯ é‡å¤§æ›´æ–°ï¼šCLI å‚æ•°ç³»ç»Ÿå…¨é¢é‡æ„ä¸ç®€åŒ–

æœ¬ç‰ˆæœ¬å¯¹ CLI å‚æ•°ç³»ç»Ÿè¿›è¡Œäº†å…¨é¢é‡æ„ï¼Œå¹¶æœ€ç»ˆç®€åŒ–ä¸ºä»…ä½¿ç”¨ `true/false` å¸ƒå°”å€¼ï¼Œå¤§å¤§é™ä½å­¦ä¹ éš¾åº¦ã€‚

### Changed
- **CLI å‚æ•°ç³»ç»Ÿç®€åŒ–** âš¡
  - æ‰€æœ‰å¸ƒå°”å‚æ•°ç»Ÿä¸€ä¸ºä»…æ”¯æŒ `true|false`ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
  - ç§»é™¤äº† yes/no, 1/0, on/off ç­‰å¤šç§å†—ä½™æ ¼å¼
  - ç®€åŒ–å¸ƒå°”å‚æ•°è§£æé€»è¾‘ï¼Œä»£ç æ›´æ¸…æ™°
  - ç”¨æˆ·å­¦ä¹ æˆæœ¬é™ä½ï¼Œä½¿ç”¨ä½“éªŒæ›´ä¸€è‡´

- **å¸ƒå°”å‚æ•°åˆ—è¡¨** ğŸ“‹
  - `-6, --ipv6[=true|false]` - IPv6 æ¨¡å¼
  - `-d, --dry-run[=true|false]` - dry-run æ¨¡å¼
  - `-T, --timestamp[=true|false]` - æ—¥å¿—æ—¶é—´æˆ³
  - `-M, --systemd[=true|false]` - systemd é›†æˆ
  - `-W, --watchdog[=true|false]` - systemd watchdog

- **ç¯å¢ƒå˜é‡ç³»ç»Ÿå®Œå–„** ğŸ“
  - æ‰€æœ‰å¸ƒå°”ç¯å¢ƒå˜é‡ç°åœ¨ä»…æ¥å— `true|false` å€¼
  - æ›´æ–°ï¼š`OPENUPS_DRY_RUN`, `OPENUPS_TIMESTAMP`, `OPENUPS_SYSTEMD`, `OPENUPS_WATCHDOG`, `OPENUPS_IPV6`
  - ä¿æŒé…ç½®ä¼˜å…ˆçº§ï¼šCLI å‚æ•° > ç¯å¢ƒå˜é‡ > é»˜è®¤å€¼

- **æ–‡æ¡£å…¨é¢æ›´æ–°** ğŸ“š
  - README.md: æ‰€æœ‰å‚æ•°è¡¨æ ¼æ”¹ä¸º `true|false` æ ¼å¼
  - QUICKSTART.md: æ‰€æœ‰ç¤ºä¾‹æ”¹ä¸ºæ–°å‚æ•°æ ¼å¼
  - systemd/openups.service: æ›´æ–°ç¯å¢ƒå˜é‡ä¸º true/false
  - .github/copilot-instructions.md: åŒæ­¥å‚æ•°è¯´æ˜

### Documentation
- ğŸ“ README.md: æ›´æ–°å‚æ•°è¡¨æ ¼å’Œæ‰€æœ‰ç¤ºä¾‹
- ğŸ“ QUICKSTART.md: æ›´æ–° 5 ä¸ªåœºæ™¯ç¤ºä¾‹
- ğŸ“ systemd/openups.service: æ›´æ–°ç¯å¢ƒå˜é‡é…ç½®
- ğŸ“ .github/copilot-instructions.md: æ›´æ–°å‚æ•°è¯´æ˜

- ### Performance
- ğŸ“Š äºŒè¿›åˆ¶å¤§å°ç»´æŒï¼š**43 KB**
- ğŸ“Š å†…å­˜å ç”¨ç»´æŒï¼š**< 5 MB**
- ğŸ“Š å®‰å…¨è¯„åˆ†ç»´æŒï¼š**10/10** ğŸ†
- ğŸ“Š ç¼–è¯‘è­¦å‘Šï¼š**0** âœ…

---

## [1.1.1] - 2025-10-27

### Changed
- **CLI å‚æ•°ç³»ç»Ÿä¼˜åŒ–**: å®Œå–„çŸ­é€‰é¡¹æ”¯æŒ
  - æ‰€æœ‰é•¿é€‰é¡¹ç°åœ¨éƒ½æ”¯æŒå¯¹åº”çš„çŸ­é€‰é¡¹
  - çŸ­é€‰é¡¹åˆ—è¡¨ï¼š`-t -i -n -w -s -r -S -D -C -P -L -6 -d -N -Y -T -M -W -Z -h`

### Fixed
- **GCC 13 å…¼å®¹æ€§**: ä¸º stdckdint.h (C23) æ·»åŠ åå¤‡å®ç°

---

## [1.1.0] - 2025-10-26

### âš¡ æ€§èƒ½å‡çº§ & ä»£ç ä¼˜åŒ–

#### Changed
- **æ—¥å¿—ç³»ç»Ÿå…¨é¢é‡æ„**: ä» key=value æ ¼å¼æ”¹ä¸ºè‡ªç„¶è¯­åº
- **æ—¥å¿—ç³»ç»Ÿç®€åŒ–**: ç»Ÿä¸€ä½¿ç”¨ `--log-level` å‚æ•°ï¼ˆsilent|error|warn|info|debugï¼‰
- **C æ ‡å‡†å‡çº§**: C11 â†’ **C2x (C23)**
- **ä¼˜åŒ–çº§åˆ«æå‡**: -O2 â†’ **-O3** + LTO + åŸç”Ÿä¼˜åŒ–

#### Security
- ğŸ” **å®‰å…¨åŠ å›ºå‡çº§**: Full RELRO, PIE, Stack Canary, NX Stack, FORTIFY_SOURCE=3

#### Performance
- ğŸ“‰ **äºŒè¿›åˆ¶å¤§å°ä¼˜åŒ–**: 45KB â†’ **39KB (-13%)**

---

## [1.0.0] - 2025-10-26

### ğŸ‰ é¦–æ¬¡å‘å¸ƒ

#### Added
- âœ¨ **å®Œæ•´çš„ C è¯­è¨€å®ç°**ï¼ˆ7 ä¸ªæ¨¡å—åŒ–ç»„ä»¶ï¼‰
- ğŸŒ **åŸç”Ÿ ICMP å®ç°**ï¼ˆIPv4/IPv6 æ”¯æŒï¼‰
- âš™ï¸ **systemd æ·±åº¦é›†æˆ**ï¼ˆnotifyã€watchdogï¼‰
- ğŸ“ **è‡ªç„¶è¯­åºæ—¥å¿—ç³»ç»Ÿ**ï¼ˆprintf é£æ ¼å¯å˜å‚æ•°ï¼‰
- ğŸ”§ **çµæ´»çš„é…ç½®ç³»ç»Ÿ**ï¼ˆCLI + ç¯å¢ƒå˜é‡ï¼‰
- ğŸ›¡ï¸ **å››ç§å…³æœºæ¨¡å¼**ï¼ˆimmediateã€delayedã€log-onlyã€customï¼‰
- ğŸ“Š **å®æ—¶ç›‘æ§æŒ‡æ ‡**ï¼ˆæˆåŠŸç‡ã€å»¶è¿Ÿã€è¿è¡Œæ—¶é•¿ï¼‰
- ğŸ”’ **å®‰å…¨ç‰¹æ€§**ï¼ˆCAP_NET_RAWã€dry-runã€è¾“å…¥éªŒè¯ï¼‰

#### Technical
- **è¯­è¨€**ï¼šC11 æ ‡å‡† | **ä»£ç é‡**ï¼š~1685 è¡Œï¼ˆv1.0.0ï¼‰ | **äºŒè¿›åˆ¶**ï¼š45 KB
- **å®‰å…¨**ï¼š10/10 | **ä¾èµ–**ï¼šé›¶ç¬¬ä¸‰æ–¹

---
